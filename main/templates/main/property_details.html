<!-- {% extends 'main/base.html' %}
{% load static %}
{% block title %}Property Details{% endblock %}

{% block content %} -->
<!-- <div class="container py-5">
  <div class="row align-items-center">
    
    <!-- Left Side: Image -->
    <!-- <div class="col-md-6 mb-4 mb-md-0">
      <img src="{% static 'main/images/service1.png' %}" class="img-fluid rounded shadow" alt="Property Image">
    </div> -->

    <!-- Right Side: Property Details Form -->
    <!-- <div class="col-md-6">
      <h2 class="fw-bold mb-3 text-center text-md-start">Property Details</h2>
      <p class="text-muted mb-4 text-center text-md-start">Base price: <strong>£100</strong>. Extra <strong>£5</strong> per item over default.</p> -->

      <!-- <div class="list-group shadow-sm"> --> -->

        <!-- Controls -->
        <!-- <div class="list-group-item d-flex justify-content-between align-items-center">
          <strong>Floors</strong>
          <div>
            <button class="btn btn-outline-secondary btn-sm" onclick="updateCount('floors', -1)">−</button>
            <span id="floors-count" class="mx-3">1</span>
            <button class="btn btn-outline-secondary btn-sm" onclick="updateCount('floors', 1)">+</button>
          </div>
        </div>

        <div class="list-group-item d-flex justify-content-between align-items-center">
          <strong>Bedrooms</strong>
          <div>
            <button class="btn btn-outline-secondary btn-sm" onclick="updateCount('bedrooms', -1)">−</button>
            <span id="bedrooms-count" class="mx-3">4</span>
            <button class="btn btn-outline-secondary btn-sm" onclick="updateCount('bedrooms', 1)">+</button>
          </div>
        </div>

        <div class="list-group-item d-flex justify-content-between align-items-center">
          <strong>Toilets</strong>
          <div>
            <button class="btn btn-outline-secondary btn-sm" onclick="updateCount('toilets', -1)">−</button>
            <span id="toilets-count" class="mx-3">3</span>
            <button class="btn btn-outline-secondary btn-sm" onclick="updateCount('toilets', 1)">+</button>
          </div> -->
        <!-- </div>

        <div class="list-group-item d-flex justify-content-between align-items-center">
          <strong>Kitchen</strong>
          <div>
            <button class="btn btn-outline-secondary btn-sm" onclick="updateCount('kitchen', -1)">−</button>
            <span id="kitchen-count" class="mx-3">1</span>
            <button class="btn btn-outline-secondary btn-sm" onclick="updateCount('kitchen', 1)">+</button>
          </div>
        </div> -->

        <!-- <div class="list-group-item d-flex justify-content-between align-items-center">
          <strong>Ovens</strong>
          <div>
            <button class="btn btn-outline-secondary btn-sm" onclick="updateCount('ovens', -1)">−</button>
            <span id="ovens-count" class="mx-3">1</span>
            <button class="btn btn-outline-secondary btn-sm" onclick="updateCount('ovens', 1)">+</button>
          </div>
        </div>

        <div class="list-group-item d-flex justify-content-between align-items-center">
          <strong>Doors</strong>
          <div>
            <button class="btn btn-outline-secondary btn-sm" onclick="updateCount('doors', -1)">−</button>
            <span id="doors-count" class="mx-3">8</span>
            <button class="btn btn-outline-secondary btn-sm" onclick="updateCount('doors', 1)">+</button>
          </div>
        </div>
      </div> -->

      <!-- Price Summary & Next -->
      <!-- <div class="mt-4 text-start">
        <h5>Total Price: <span id="total-price">£100</span></h5>
            <form method="post" action="{% url 'client_payment' %}" onsubmit="return prepareForm()">
            {% csrf_token %}
            <input type="hidden" name="final_amount" id="finalAmountInput">
            <button type="submit" class="btn btn-primary btn-lg mt-3 px-5">Next</button>
            </form> -->

      <!-- </div>
    </div>
  </div>
</div> -->

<!-- Script for Live Price Calculation -->
<!-- <script>
  const defaults = {
    floors: 2,
    bedrooms: 4,
    toilets: 3,
    kitchen: 1,
    ovens: 1,
    doors: 6
  };

  let counts = { ...defaults };
  const basePrice = 100;
  const extraCharge = 5;

  function updateCount(item, change) {
    const countSpan = document.getElementById(`${item}-count`);
    counts[item] = Math.max(0, counts[item] + change);
    countSpan.textContent = counts[item];
    updatePrice();
  }

  function updatePrice() {
    let totalExtras = 0;
    for (let key in counts) {
      if (counts[key] > defaults[key]) {
        totalExtras += (counts[key] - defaults[key]);
      }
    }
    const total = basePrice + (totalExtras * extraCharge);
    document.getElementById("total-price").textContent = `£${total}`;
    document.getElementById("finalAmountInput").value = total.toFixed(2);
  }

  function prepareForm() { -->
    <!-- updatePrice();  // Ensure value is set before submitting
    return true;    // Allow form to submit
  }

  // Initial setup
  updatePrice();
<!-- </script> -->


<div class="container py-5">
  <div class="row align-items-center">
    
    <!-- Left: Image -->
    <div class="col-md-5 text-center">
      <img src="{% static 'main/images/service1.png' %}" alt="Property" class="img-fluid shadow rounded">
    </div>

    <!-- Right: Form -->
    <div class="col-md-7">
      <h2 class="fw-bold mb-4">Tell Us About Your Property</h2>

      <form method="post" action="{% url 'client_payment' %}">
        {% csrf_token %}

        <div class="row g-3">
          {% comment "Property Items" %}
          {% for label, name, default in items %}
            {{ loop block goes here if dynamic }}
          {% endcomment %}

          <!-- Floors -->
          <div class="col-6">
            <label class="form-label">Floors</label>
            <div class="input-group">
              <button type="button" class="btn btn-outline-secondary" onclick="updateQty('floors', -1)">−</button>
              <input type="text" id="floors" name="floors" class="form-control text-center" value="1" readonly>
              <button type="button" class="btn btn-outline-secondary" onclick="updateQty('floors', 1)">+</button>
            </div>
          </div>

          <!-- Rooms -->
          <div class="col-6">
            <label class="form-label">Rooms</label>
            <div class="input-group">
              <button type="button" class="btn btn-outline-secondary" onclick="updateQty('rooms', -1)">−</button>
              <input type="text" id="rooms" name="rooms" class="form-control text-center" value="4" readonly>
              <button type="button" class="btn btn-outline-secondary" onclick="updateQty('rooms', 1)">+</button>
            </div>
          </div>

          <!-- Bedrooms -->
          <div class="col-6">
            <label class="form-label">Bedrooms</label>
            <div class="input-group">
              <button type="button" class="btn btn-outline-secondary" onclick="updateQty('bedrooms', -1)">−</button>
              <input type="text" id="bedrooms" name="bedrooms" class="form-control text-center" value="4" readonly>
              <button type="button" class="btn btn-outline-secondary" onclick="updateQty('bedrooms', 1)">+</button>
            </div>
          </div>

          <!-- Toilets -->
          <div class="col-6">
            <label class="form-label">Toilets</label>
            <div class="input-group">
              <button type="button" class="btn btn-outline-secondary" onclick="updateQty('toilets', -1)">−</button>
              <input type="text" id="toilets" name="toilets" class="form-control text-center" value="3" readonly>
              <button type="button" class="btn btn-outline-secondary" onclick="updateQty('toilets', 1)">+</button>
            </div>
          </div>

          <!-- Ovens -->
          <div class="col-6">
            <label class="form-label">Ovens</label>
            <div class="input-group">
              <button type="button" class="btn btn-outline-secondary" onclick="updateQty('ovens', -1)">−</button>
              <input type="text" id="ovens" name="ovens" class="form-control text-center" value="1" readonly>
              <button type="button" class="btn btn-outline-secondary" onclick="updateQty('ovens', 1)">+</button>
            </div>
          </div>

          <!-- Doors -->
          <div class="col-6">
            <label class="form-label">Doors</label>
            <div class="input-group">
              <button type="button" class="btn btn-outline-secondary" onclick="updateQty('doors', -1)">−</button>
              <input type="text" id="doors" name="doors" class="form-control text-center" value="4" readonly>
              <button type="button" class="btn btn-outline-secondary" onclick="updateQty('doors', 1)">+</button>
            </div>
          </div>
        </div>

        <hr class="my-4">
        <div class="d-flex justify-content-between align-items-center">
          <h5 class="mb-0">Estimated Price: <strong>£<span id="price">100.00</span></strong></h5>
          <button type="submit" class="btn btn-success px-4">Next</button>
        </div>
      </form>
    </div>
  </div>
</div>

<!-- Script for quantity and price -->
<script>
  const defaultValues = {
    rooms: 4,
    bedrooms: 4,
    toilets: 3,
    ovens: 1,
    doors: 4,
    floors: 1,
  };
  const basePrice = 100;
  const extraUnitPrice = 5;

  function updateQty(field, change) {
    const input = document.getElementById(field);
    let value = parseInt(input.value) || 0;
    value = Math.max(0, value + change);
    input.value = value;
    calculatePrice();
  }

  function calculatePrice() {
    let total = basePrice;

    for (const [key, defaultVal] of Object.entries(defaultValues)) {
      const currentVal = parseInt(document.getElementById(key).value) || 0;
      if (currentVal > defaultVal) {
        total += (currentVal - defaultVal) * extraUnitPrice;
      }
    }

    document.getElementById("price").innerText = total.toFixed(2);
  }

  // Calculate price initially
  window.onload = calculatePrice;
</script>
{% endblock %}
